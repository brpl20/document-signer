meta {
  name: ITI Verificador
  type: http
  seq: 1
}

post {
  url: {{iti_url}}/report
  body: multipartForm
  auth: none
}

body:multipart-form {
  report_type: json
  signature_files[]: @file(./test/document.pdf.p7s)
  detached_files[]: @file(./test/document.pdf)
  verify_incremental_updates: true
}

vars:pre-request {
  iti_url: https://verificador.iti.gov.br
}

settings {
  encodeUrl: true
}

docs {
  Validate signature using the official ITI Verificador (Brazilian Government).
  This is the official source of truth for ICP-Brasil digital signatures.

  Environments:
  - Production: https://verificador.iti.gov.br
  - Staging: https://verificador.staging.iti.br

  Parameters:
  - report_type: "json" for JSON response, "pdf" for PDF report
  - signature_files[]: The .p7s signature file (detached signature)
  - detached_files[]: The original PDF document
  - verify_incremental_updates: true to verify PDF incremental updates

  For embedded signatures (signed PDF):
  - Only send signature_files[] with the signed PDF
  - Leave detached_files[] empty

  Response: JSON report with signature validation details including:
  - Signer information (CN, CPF, etc.)
  - Certificate chain validation
  - Signature algorithm
  - Timestamp information
  - Overall validity status

  Official Documentation:
  - Portal: https://validar.iti.gov.br
  - Developer Guide: https://validar.iti.gov.br/guia-desenvolvedor.html
}
