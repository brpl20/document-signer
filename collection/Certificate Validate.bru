meta {
  name: Certificate Validate
  type: http
  seq: 7
}

post {
  url: {{base_url}}/certificate/validate
  body: multipartForm
  auth: none
}

body:multipart-form {
  certificate: @file(./test/certificate.pfx)
  password: {{cert_password}}
}

vars:pre-request {
  base_url: http://localhost:8080/api/v1
  cert_password: 12345678
}

settings {
  encodeUrl: true
}

docs {
  Validate certificate password and check if certificate is not expired.
  Use this before signing to ensure the certificate is ready to use.

  Parameters:
  - certificate: PFX/PKCS12 certificate file
  - password: Certificate password

  Response JSON (Success):
  HTTP 200
  {
    "valid": true,
    "message": "Certificate is valid and not expired",
    "timestamp": "2024-01-10T12:00:00.000Z"
  }

  Response JSON (Wrong Password):
  HTTP 401
  {
    "success": false,
    "error": "Incorrect certificate password",
    "code": "INVALID_PASSWORD"
  }

  Response JSON (Expired Certificate):
  HTTP 422
  {
    "success": false,
    "error": "Certificate expired on Sat Jan 01 00:00:00 BRT 2024",
    "code": "CERTIFICATE_EXPIRED"
  }
}
